# ููู OAuth ููููุงุช ุงููุฑูุฑ - ุฏููู ุดุงูู

## โ ุงูุณุคุงู: ูู ูููู ุญูุธ ูููุฉ ูุฑูุฑ Google ูููุณุชุฎุฏูููุ

### โ ุงูุฅุฌุงุจุฉ ุงููุตูุฑุฉ: ูุงุ ูุณุชุญูู ูููููุน!

---

## ๐ ููู ูุนูู Google OAuthุ

### ุงูุนูููุฉ ุงููุงููุฉ:

```
1. ุงููุณุชุฎุฏู ูุถุบุท "ุชุณุฌูู ุฏุฎูู ุจู Google"
   โ
2. ูุชู ุชูุฌููู ุฅูู ุตูุญุฉ Google (ููุณ ูู ุชุทุจููู!)
   โ
3. ูุฏุฎู ุฅููููู ููููุฉ ูุฑูุฑ Google (ุนูู ูููุน Google)
   โ
4. Google ุชุชุญูู ูู ุงููููุฉ
   โ
5. Google ุชุณุฃู: "ูู ุชุณูุญ ูู [ุงุณู ุชุทุจููู] ุจุงููุตูู ูุจูุงูุงุชูุ"
   โ
6. ุงููุณุชุฎุฏู ููุงูู
   โ
7. Google ุชุฑุณู ูุชุทุจููู:
   - โ Access Token (ููุชุงุญ ูุคูุช)
   - โ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - โ ุงูุงุณู
   - โ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ
   - โ ูููุฉ ุงููุฑูุฑ (ูุง ุชุฑุณู ุฃุจุฏุงู!)
   โ
8. ุชุทุจููู ูุญูุธ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ููุท
```

---

## ๐ ูุง ุงูุฐู ูุชู ุญูุธู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ

### ูุซุงู 1: ูุณุชุฎุฏู ุณุฌู ุจุงูุฅูููู ููููุฉ ุงููุฑูุฑ

```json
{
  "id": "clx123abc",
  "email": "ahmed@example.com",
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "password": "$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy",
  "image": null,
  "emailVerified": null,
  "role": "USER"
}
```

**ููุงุญุธุฉ:** ูููุฉ ุงููุฑูุฑ **ูุดูุฑุฉ** ุจู bcryptุ ูุง ูููู ูู ุชุดููุฑูุง!

---

### ูุซุงู 2: ูุณุชุฎุฏู ุณุฌู ุจู Google OAuth

```json
{
  "id": "clx456def",
  "email": "mohamed@gmail.com",
  "name": "ูุญูุฏ ุนูู",
  "password": null,  // โ ูุง ุชูุฌุฏ ูููุฉ ูุฑูุฑ!
  "image": "https://lh3.googleusercontent.com/a/...",
  "emailVerified": "2025-12-21T00:00:00.000Z",
  "role": "USER"
}
```

**ููุงุญุธุฉ:** `password` ูู `null` ูุฃู ุงููุณุชุฎุฏู ูู ูุญุฏุฏ ูููุฉ ูุฑูุฑ ูู ุชุทุจููู!

---

## ๐ก๏ธ ููุงุฐุง ูุฐุง ุขููุ

### 1. **ุงูุชุดููุฑ ุฃุญุงุฏู ุงูุงุชุฌุงู (One-way Hashing)**

```typescript
// ุนูุฏ ุงูุชุณุฌูู
const password = "MyPassword123";
const hashed = await bcrypt.hash(password, 10);
// ุงููุชูุฌุฉ: "$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy"

// ูุง ูููู ุงูุนูุฏุฉ ูู Hash ุฅูู Password ุงูุฃุตูู!
// โ bcrypt.decrypt(hashed) // ูุง ุชูุฌุฏ ูุฐู ุงูุฏุงูุฉ!
```

### 2. **ุงูุชุญูู ูู ูููุฉ ุงููุฑูุฑ**

```typescript
// ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
const inputPassword = "MyPassword123";
const storedHash = "$2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy";

const isValid = await bcrypt.compare(inputPassword, storedHash);
// ุงููุชูุฌุฉ: true ุฃู false
```

### 3. **OAuth Tokens**

```typescript
// Google ุชุฑุณู Access Token ูุคูุช
{
  "access_token": "ya29.a0AfH6SMBx...",
  "expires_in": 3600,  // ุณุงุนุฉ ูุงุญุฏุฉ
  "token_type": "Bearer",
  "scope": "email profile openid"
}
```

**ุงูู Token:**
- โ ูุคูุช (ููุชูู ุจุนุฏ ุณุงุนุฉ)
- โ ูุญุฏูุฏ ุงูุตูุงุญูุงุช (email, profile ููุท)
- โ ูููู ุฅูุบุงุคู ูู ุฃู ููุช
- โ ููุณ ูููุฉ ูุฑูุฑ!

---

## ๐ค ุณููุงุฑูููุงุช ุดุงุฆุนุฉ

### ุงูุณููุงุฑูู 1: ูุณุชุฎุฏู ุณุฌู ุจู Googleุ ูุฑูุฏ ุชุณุฌูู ุฏุฎูู ุจุงูุฅูููู

**ุงูุญู:**
- ุงุณูุญ ูู ุจุฅูุดุงุก ูููุฉ ูุฑูุฑ **ุฌุฏูุฏุฉ** (ููุณุช ูููุฉ ูุฑูุฑ Google!)
- ุงุญูุธูุง ูุดูุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุขู ููููู ุชุณุฌูู ุงูุฏุฎูู ุจุทุฑููุชูู

**ูุซุงู ููุฏ:** ุฑุงุฌุน ููู `EXAMPLE_add_password_api.ts`

---

### ุงูุณููุงุฑูู 2: ูุณุชุฎุฏู ุณุฌู ุจุงูุฅููููุ ูุฑูุฏ ุฑุจุท ุญุณุงุจ Google

**ุงูุญู:**
- ุชุญูู ูู ุฃู ุงูุฅูููู ูุชุทุงุจู
- ุงุณูุญ ุจุฑุจุท ุงูุญุณุงุจ
- ุงูุขู ููููู ุชุณุฌูู ุงูุฏุฎูู ุจุทุฑููุชูู

---

### ุงูุณููุงุฑูู 3: ุฅูููู ูุงุญุฏุ ุทุฑููุชุงู ูุฎุชููุชุงู

**ุงููุดููุฉ:**
```
user1@gmail.com ุณุฌู ุจุงูุฅูููู ููููุฉ ุงููุฑูุฑ
user1@gmail.com ูุญุงูู ุงูุชุณุฌูู ุจู Google OAuth
```

**ุงูุญู ุงูุญุงูู ูู ุงูููุฏ:**
```typescript
// ูู authOptions.ts
async signIn({ user, account, profile }) {
  if (account?.provider === "google") {
    const existingUser = await prisma.user.findUnique({
      where: { email: user.email! }
    });

    if (!existingUser) {
      // ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ
      await prisma.user.create({ ... });
    }
    // ุฅุฐุง ูุงู ููุฌูุฏุ ูุณุฌู ุงูุฏุฎูู ูุจุงุดุฑุฉ
    return true;
  }
  return true;
}
```

---

## ๐ ุฌุฏูู ููุงุฑูุฉ

| ุงูููุฒุฉ | ุชุณุฌูู ุจุงูุฅูููู | ุชุณุฌูู ุจู Google |
|-------|----------------|-----------------|
| **ูููุฉ ุงููุฑูุฑ** | ูุญููุธุฉ ูุดูุฑุฉ | ูุง ุชูุฌุฏ |
| **ุงูุชุญูู ูู ุงูุฅูููู** | ูุฏูู (ุนุจุฑ ุฑุงุจุท) | ุชููุงุฆู |
| **ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ** | ูุฏูู | ุชููุงุฆู ูู Google |
| **ุงูุฃูุงู** | ูุนุชูุฏ ุนูู ููุฉ ูููุฉ ุงููุฑูุฑ | ูุนุชูุฏ ุนูู ุฃูุงู Google |
| **ุณูููุฉ ุงูุงุณุชุฎุฏุงู** | ูุญุชุงุฌ ุชุฐูุฑ ูููุฉ ูุฑูุฑ | ููุฑุฉ ูุงุญุฏุฉ |

---

## โ๏ธ ุฃุฎุทุงุก ุดุงุฆุนุฉ ูุฌุจ ุชุฌูุจูุง

### โ ุฎุทุฃ 1: ุญูุธ ูููุฉ ูุฑูุฑ Google
```typescript
// โ ุฎุทุฃ ูุงุฏุญ!
const googlePassword = user.password; // ูุง ุชูุฌุฏ!
await prisma.user.create({
  data: {
    email: user.email,
    password: googlePassword // โ ูุณุชุญูู!
  }
});
```

### โ ุฎุทุฃ 2: ุญูุธ ูููุฉ ูุฑูุฑ ุบูุฑ ูุดูุฑุฉ
```typescript
// โ ุฎุทุฃ ุฃููู ุฎุทูุฑ!
await prisma.user.create({
  data: {
    email: email,
    password: plainPassword // โ ูุฌุจ ุชุดููุฑูุง!
  }
});
```

### โ ุงูุตุญูุญ:
```typescript
// โ ุตุญูุญ
const hashedPassword = await bcrypt.hash(plainPassword, 10);
await prisma.user.create({
  data: {
    email: email,
    password: hashedPassword // โ ูุดูุฑุฉ
  }
});
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

### ูุง ูุญุฏุซ ูุนููุงู:

| ููุน ุงูุชุณุฌูู | ูุง ูุชู ุญูุธู |
|------------|-------------|
| **Email + Password** | Email, Name, **Hashed Password** |
| **Google OAuth** | Email, Name, Image, **No Password** |

### ุงูููุงุนุฏ ุงูุฐูุจูุฉ:

1. โ **ูุง ุชุญูุธ ูููุงุช ูุฑูุฑ ุบูุฑ ูุดูุฑุฉ ุฃุจุฏุงู**
2. โ **Google ูุง ุชุฑุณู ูููุฉ ุงููุฑูุฑ ุฃุจุฏุงู**
3. โ **ุงุณุชุฎุฏู bcrypt ูุชุดููุฑ ูููุงุช ุงููุฑูุฑ**
4. โ **OAuth Tokens ููุณุช ูููุงุช ูุฑูุฑ**
5. โ **ุญูู password ูููู ุฃู ูููู null ูููุณุชุฎุฏููู ูู OAuth**

---

## ๐ ูุตุงุฏุฑ ุฅุถุงููุฉ

- [OAuth 2.0 Explained](https://oauth.net/2/)
- [Google OAuth Documentation](https://developers.google.com/identity/protocols/oauth2)
- [NextAuth.js Documentation](https://next-auth.js.org/)
- [bcrypt Documentation](https://www.npmjs.com/package/bcryptjs)

---

## ๐ก ูุตูุญุฉ ุฃุฎูุฑุฉ

ุฅุฐุง ุฃุฑุฏุช ุงูุณูุงุญ ูููุณุชุฎุฏููู ุจุชุณุฌูู ุงูุฏุฎูู ุจุทุฑู ูุชุนุฏุฏุฉ:
1. ุงุณูุญ ููู ุจุฅุถุงูุฉ ูููุฉ ูุฑูุฑ **ุฌุฏูุฏุฉ** (ููุณุช ูููุฉ ูุฑูุฑ Google)
2. ุงุณูุญ ููู ุจุฑุจุท ุญุณุงุจุงุช OAuth ูุชุนุฏุฏุฉ
3. ุงุญูุธ ูู ุดูุก ุจุดูู ุขูู ููุดูุฑ

**ุชุฐูุฑ:** ุงูุฃูุงู ุฃููุงู! ๐
