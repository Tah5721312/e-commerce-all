# ุฏููู ูุธุงู ุงูุทูุจุงุช - Order System Guide

## โ ุงูููุฒุงุช ุงููุถุงูุฉ

### 1. ุญูุธ ุงูุทูุจุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชู ุฅูุดุงุก ุฌุฏูู `orders` ูุญูุธ ูุนูููุงุช ุงูุทูุจุงุช
- ุชู ุฅูุดุงุก ุฌุฏูู `order_items` ูุญูุธ ุชูุงุตูู ุงูููุชุฌุงุช ูู ูู ุทูุจ
- ูู ุทูุจ ูู ุฑูู ูุฑูุฏ (Order Number)

### 2. ุตูุญุฉ ุดูุฑุงู ูู
- ุตูุญุฉ `/thank-you` ุชุนุฑุถ ุจุนุฏ ุงูุฏูุน ุงููุงุฌุญ
- ุชุนุฑุถ ุฑูู ุงูุทูุจ ูุชูุงุตูู ุงูุชุฃููุฏ
- ุชุตููู ุซูุงุฆู ุงููุบุฉ (ุนุฑุจู/ุฅูุฌููุฒู)

### 3. ุฅุฑุณุงู ุจุฑูุฏ ุชุฃููุฏ
- ูุชู ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ุชููุงุฆูุงู ุจุนุฏ ุงูุฏูุน ุงููุงุฌุญ
- ูุญุชูู ุนูู ุฑูู ุงูุทูุจ ูุชูุงุตูู ุงูุทูุจ
- ูุณุชุฎุฏู Resend ูุฅุฑุณุงู ุงูุจุฑูุฏ

### 4. ุชุฏูู ุงูุนูู ุงููุงูู
1. ุงูุนููู ูุถูู ููุชุฌุงุช ููุณูุฉ
2. ูุฐูุจ ูุตูุญุฉ Checkout
3. ูููุฃ ุจูุงูุงุช ุงูุฏูุน
4. ูุชู ุงูุฏูุน ุนุจุฑ Stripe
5. ูุชู ุญูุธ ุงูุทูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
6. ูุชู ุฅุฑุณุงู ุจุฑูุฏ ุงูุชุฃููุฏ
7. ูุชู ุงูุชูุฌูู ูุตูุญุฉ "ุดูุฑุงู ูู"

## ๐ ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู Orders
```sql
- id: ุฑูู ุงูุทูุจ
- order_number: ุฑูู ุงูุทูุจ ุงููุฑูุฏ (ูุซู ORD-1234567890-123)
- customer_name: ุงุณู ุงูุนููู
- customer_email: ุจุฑูุฏ ุงูุนููู
- customer_address: ุนููุงู ุงูุนููู
- customer_city: ุงููุฏููุฉ
- customer_postal_code: ุงูุฑูุฒ ุงูุจุฑูุฏู
- customer_country: ุงูุฏููุฉ
- total_amount: ุงููุจูุบ ุงูุฅุฌูุงูู
- status: ุญุงูุฉ ุงูุทูุจ (pending, processing, shipped, delivered, cancelled)
- stripe_payment_intent_id: ูุนุฑู ุงูุฏูุน ูู Stripe
- created_at: ุชุงุฑูุฎ ุงูุฅูุดุงุก
- updated_at: ุชุงุฑูุฎ ุงูุชุญุฏูุซ
```

### ุฌุฏูู Order Items
```sql
- id: ุฑูู ุงูุนูุตุฑ
- order_id: ุฑูู ุงูุทูุจ
- product_id: ุฑูู ุงูููุชุฌ
- product_title: ุนููุงู ุงูููุชุฌ
- product_price: ุณุนุฑ ุงูููุชุฌ
- quantity: ุงููููุฉ
- subtotal: ุงููุฌููุน ุงููุฑุนู
- created_at: ุชุงุฑูุฎ ุงูุฅูุดุงุก
```

## ๐ง ุงูุฅุนุฏุงุฏ

### 1. ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ

ุฃุถู ูู ููู `.env.local`:

```env
# Stripe (ูุทููุจ ููุฏูุน)
STRIPE_SECRET_KEY=sk_test_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...

# Resend (ุงุฎุชูุงุฑู - ูุฅุฑุณุงู ุงูุจุฑูุฏ)
RESEND_API_KEY=re_...
RESEND_FROM_EMAIL=noreply@yourdomain.com
```

### 2. ุฅุนุฏุงุฏ Resend (ุงุฎุชูุงุฑู)

**ููุญุตูู ุนูู API Key:**
1. ุงุฐูุจ ุฅูู [https://resend.com](https://resend.com)
2. ุณุฌู ุญุณุงุจ ุฌุฏูุฏ (ูุฌุงูู)
3. ุงุญุตู ุนูู API Key ูู Dashboard
4. ุฃุถู `RESEND_API_KEY` ูู `.env.local`

**ููุงุญุธุฉ:** ุฅุฐุง ูู ุชุถูู `RESEND_API_KEY`ุ ุณูุชู ููุท ุทุจุงุนุฉ ุงูุจุฑูุฏ ูู console (ููุชุทููุฑ)

### 3. ุชุทุจูู Migration

ุชู ุชุทุจูู migration ุชููุงุฆูุงู. ุฅุฐุง ููุช ุชุฑูุฏ ุชุทุจููู ูุฏููุงู:

```bash
pnpm db:migrate
```

## ๐ง ุฅุนุฏุงุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

### ุจุฏูู Resend (ููุชุทููุฑ)
- ุงูุจุฑูุฏ ุณูุชู ุทุจุงุนุชู ูู console ููุท
- ูููุฏ ููุงุฎุชุจุงุฑ ูุงูุชุทููุฑ

### ูุน Resend (ููุฅูุชุงุฌ)
1. ุณุฌู ูู [Resend](https://resend.com)
2. ุงุญุตู ุนูู API Key
3. ุฃุถู `RESEND_API_KEY` ูู `.env.local`
4. ุฃุถู `RESEND_FROM_EMAIL` (ูุฌุจ ุฃู ูููู ูู ูุทุงู ูุณุฌู ูู Resend)

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุญูุธ ุงูุทูุจ
- ูู ุจุนูููุฉ ุฏูุน ุชุฌุฑูุจูุฉ
- ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู ุงูุทูุจ ุชู ุญูุธู
- ุชุญูู ูู ุฑูู ุงูุทูุจ ูู ุตูุญุฉ "ุดูุฑุงู ูู"

### 2. ุงุฎุชุจุงุฑ ุงูุจุฑูุฏ
- ุฅุฐุง ูุงู `RESEND_API_KEY` ููุฌูุฏุ ุณูุชู ุฅุฑุณุงู ุจุฑูุฏ ุญูููู
- ุฅุฐุง ูู ููู ููุฌูุฏุ ุชุญูู ูู console ููุจุฑูุฏ

### 3. ุนุฑุถ ุงูุทูุจุงุช
ููููู ุงุณุชุฎุฏุงู Prisma Studio ูุนุฑุถ ุงูุทูุจุงุช:

```bash
pnpm db:studio
```

## ๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ

1. `src/app/api/orders/create/route.ts` - API ูุญูุธ ุงูุทูุจุงุช
2. `src/app/api/orders/send-confirmation/route.ts` - API ูุฅุฑุณุงู ุงูุจุฑูุฏ
3. `src/app/thank-you/page.tsx` - ุตูุญุฉ ุดูุฑุงู ูู
4. `prisma/schema.prisma` - ุชู ุชุญุฏูุซู ุจุฅุถุงูุฉ Order ู OrderItem

## ๐ ุงูุชุญุฏูุซุงุช ุนูู ุงููููุงุช ุงูููุฌูุฏุฉ

1. `src/components/checkout/PaymentForm.tsx` - ุชู ุชุญุฏูุซู ูุญูุธ ุงูุทูุจ ุจุนุฏ ุงูุฏูุน
2. `src/lib/env.ts` - ุชู ุฅุถุงูุฉ ูุชุบูุฑุงุช Resend

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

1. **ุตูุญุฉ ุนุฑุถ ุงูุทูุจุงุช:** ุฅูุดุงุก ุตูุญุฉ ูุนุฑุถ ุฌููุน ุงูุทูุจุงุช
2. **ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ:** ุฅุถุงูุฉ ูุงุฌูุฉ ูุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ
3. **ุชุชุจุน ุงูุดุญู:** ุฅุถุงูุฉ ูุธุงู ุชุชุจุน ุงูุดุญู
4. **ุฅุดุนุงุฑุงุช:** ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ุนูุฏ ุชุบููุฑ ุญุงูุฉ ุงูุทูุจ

## ๐ ููุงุญุธุงุช

- ุฑูู ุงูุทูุจ ูุชู ุฅูุดุงุคู ุชููุงุฆูุงู ุจุตูุบุฉ: `ORD-{timestamp}-{random}`
- ุญุงูุฉ ุงูุทูุจ ุงูุงูุชุฑุงุถูุฉ ูู `pending`
- ูุชู ุญูุธ `stripe_payment_intent_id` ููุฑุจุท ูุน Stripe
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุชู ุฅุฑุณุงูู ุจุดูู ุบูุฑ ูุชุฒุงูู (ูุง ูููุน ุฅุชูุงู ุงูุทูุจ)

